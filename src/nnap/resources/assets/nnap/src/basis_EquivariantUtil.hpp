#ifndef BASIS_EQUIVARIANT_UTIL_H
#define BASIS_EQUIVARIANT_UTIL_H

namespace JSE_NNAP {

static constexpr jint CG_SIZE[5][25] = {{
    1
},{
    4,
    1, 1, 1
},{
    9,
    5, 4, 5,
    4, 5, 9, 5, 6
},{
    16,
    13, 9, 13,
    13, 14, 17, 14, 16,
    8, 9, 13, 9, 13, 9, 8
},{
    25,
    25, 16, 25,
    27, 29, 31, 29, 31,
    21, 24, 29, 19, 29, 24, 21,
    16, 21, 26, 28, 30, 28, 29, 21, 19
}};
static constexpr jint CG_INDEX1[5][25][40] = {{
    {0}
},{
    {0, 1, 2, 3},
    {0}, {0}, {0}
},{
    {0, 1, 2, 3, 4, 5, 6, 7, 8},
    {0, 1, 1, 2, 3}, {0, 1, 2, 3}, {0, 1, 2, 3, 3},
    {0, 1, 4, 5}, {0, 1, 4, 5, 5}, {0, 1, 2, 3, 4, 5, 6, 7, 8}, {0, 2, 4, 6, 7}, {0, 1, 3, 5, 6, 7}
},{
    {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15},
    {0, 1, 1, 2, 3, 4, 4, 5, 5, 6, 7, 8, 8},
    {0, 1, 2, 3, 4, 5, 6, 7, 8},
    {0, 1, 2, 3, 3, 4, 4, 5, 6, 7, 7, 8, 8},
    {0, 1, 1, 1, 2, 3, 3, 4, 5, 9, 10, 11, 11},
    {0, 1, 1, 1, 2, 3, 4, 5, 5, 9, 10, 10, 11, 11},
    {0, 1, 1, 2, 2, 3, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15},
    {0, 1, 2, 2, 3, 3, 4, 6, 7, 9, 10, 12, 13, 14},
    {0, 1, 1, 1, 2, 3, 3, 3, 5, 6, 7, 9, 11, 12, 13, 13},
    {0, 1, 3, 4, 5, 6, 7, 8},
    {0, 1, 2, 3, 4, 5, 5, 7, 7},
    {0, 1, 1, 2, 3, 4, 4, 5, 5, 6, 7, 8, 8},
    {0, 1, 2, 3, 4, 5, 6, 7, 8},
    {0, 1, 2, 3, 3, 4, 4, 5, 6, 7, 7, 8, 8},
    {0, 1, 2, 3, 5, 5, 7, 7, 8},
    {0, 1, 3, 4, 5, 6, 7, 8}
},{
    {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24},
    {0, 1, 1, 2, 3, 4, 4, 5, 5, 6, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 13, 14, 14, 15, 15},
    {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15},
    {0, 1, 2, 3, 3, 4, 4, 5, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 12, 13, 13, 14, 14, 15, 15},
    {0, 1, 1, 1, 2, 3, 3, 4, 4, 4, 5, 5, 5, 6, 7, 7, 8, 9, 10, 11, 11, 16, 17, 18, 18, 19, 19},
    {0, 1, 1, 1, 2, 3, 4, 4, 4, 5, 5, 5, 5, 6, 7, 8, 8, 9, 10, 10, 11, 11, 16, 17, 17, 18, 18, 19, 19},
    {0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24},
    {0, 1, 2, 2, 3, 3, 4, 4, 4, 5, 6, 6, 7, 7, 7, 8, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23},
    {0, 1, 1, 1, 2, 3, 3, 3, 4, 5, 5, 5, 6, 6, 7, 7, 7, 8, 8, 9, 11, 12, 13, 13, 16, 17, 19, 20, 21, 21, 22},
    {0, 1, 1, 1, 2, 3, 3, 3, 4, 5, 6, 7, 8, 9, 10, 11, 11, 12, 13, 13, 14},
    {0, 1, 1, 1, 2, 2, 3, 3, 3, 4, 5, 5, 7, 7, 9, 10, 10, 11, 11, 12, 13, 13, 14, 15},
    {0, 1, 1, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 13, 14, 14, 15, 15},
    {0, 1, 1, 2, 2, 3, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15},
    {0, 1, 1, 2, 2, 3, 3, 3, 3, 4, 4, 5, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 12, 13, 13, 14, 14, 15, 15},
    {0, 1, 1, 1, 2, 2, 3, 3, 3, 5, 5, 7, 7, 8, 9, 10, 11, 11, 12, 13, 13, 14, 14, 15},
    {0, 1, 1, 1, 2, 3, 3, 3, 4, 5, 6, 7, 8, 10, 11, 11, 12, 13, 13, 14, 15},
    {0, 1, 3, 4, 4, 5, 6, 7, 8, 9, 10, 11, 16, 17, 18, 19},
    {0, 1, 2, 3, 4, 4, 5, 5, 5, 6, 7, 7, 8, 9, 10, 11, 16, 17, 18, 19, 19},
    {0, 1, 1, 2, 3, 3, 4, 4, 4, 5, 5, 5, 6, 7, 7, 8, 9, 10, 11, 11, 16, 17, 18, 18, 19, 19},
    {0, 1, 1, 2, 3, 4, 4, 4, 5, 5, 5, 5, 6, 7, 8, 8, 9, 10, 10, 11, 11, 16, 17, 17, 18, 18, 19, 19},
    {0, 1, 2, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24},
    {0, 1, 2, 3, 3, 4, 4, 4, 5, 6, 6, 7, 7, 7, 8, 8, 9, 10, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23},
    {0, 1, 1, 2, 3, 3, 4, 5, 5, 5, 6, 6, 7, 7, 7, 8, 8, 9, 11, 12, 13, 13, 16, 17, 19, 20, 21, 21, 22},
    {0, 1, 2, 3, 4, 4, 5, 5, 6, 7, 7, 7, 8, 10, 12, 13, 16, 18, 20, 21, 21},
    {0, 1, 3, 4, 4, 5, 6, 7, 8, 8, 9, 10, 13, 14, 17, 18, 20, 21, 22}
}};
static constexpr jint CG_INDEX2[5][25][40] = {{
    {0}
},{
    {0, 1, 2, 3},
    {1}, {2}, {3}
},{
    {0, 1, 2, 3, 4, 5, 6, 7, 8},
    {1, 6, 8, 5, 4}, {2, 5, 6, 7}, {3, 4, 7, 6, 8},
    {4, 3, 6, 7}, {5, 2, 7, 6, 8}, {6, 1, 2, 3, 4, 5, 6, 7, 8}, {7, 3, 5, 7, 8}, {8, 1, 3, 5, 8, 7}
},{
    {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15},
    {1, 6, 8, 5, 4, 13, 15, 12, 14, 11, 10, 9, 11},
    {2, 5, 6, 7, 10, 11, 12, 13, 14},
    {3, 4, 7, 6, 8, 9, 11, 10, 13, 12, 14, 13, 15},
    {4, 3, 13, 15, 10, 9, 11, 6, 7, 13, 12, 13, 15},
    {5, 2, 12, 14, 11, 10, 7, 6, 8, 14, 13, 15, 12, 14},
    {6, 1, 11, 2, 12, 3, 13, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15},
    {7, 10, 3, 13, 12, 14, 5, 7, 8, 10, 11, 13, 14, 15},
    {8, 1, 9, 11, 14, 3, 13, 15, 5, 8, 7, 11, 11, 14, 13, 15},
    {9, 8, 4, 13, 14, 9, 10, 11},
    {10, 7, 4, 5, 12, 13, 15, 9, 11},
    {11, 6, 8, 5, 4, 13, 15, 12, 14, 11, 10, 9, 11},
    {12, 5, 6, 7, 10, 11, 12, 13, 14},
    {13, 4, 7, 6, 8, 9, 11, 10, 13, 12, 14, 13, 15},
    {14, 5, 8, 7, 9, 11, 13, 15, 12},
    {15, 4, 8, 11, 10, 15, 14, 13}
},{
    {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24},
    {1, 6, 8, 5, 4, 13, 15, 12, 14, 11, 10, 9, 11, 22, 24, 21, 23, 20, 22, 19, 18, 17, 19, 16, 18},
    {2, 5, 6, 7, 10, 11, 12, 13, 14, 17, 18, 19, 20, 21, 22, 23},
    {3, 4, 7, 6, 8, 9, 11, 10, 13, 12, 14, 13, 15, 16, 18, 17, 19, 18, 21, 20, 22, 21, 23, 22, 24},
    {4, 3, 13, 15, 10, 9, 11, 6, 20, 24, 7, 21, 23, 18, 17, 19, 16, 13, 12, 13, 15, 22, 21, 20, 24, 21, 23},
    {5, 2, 12, 14, 11, 10, 7, 21, 23, 6, 8, 20, 22, 19, 18, 17, 19, 14, 13, 15, 12, 14, 23, 22, 24, 21, 23, 20, 22},
    {6, 1, 11, 2, 12, 3, 13, 4, 18, 5, 19, 6, 20, 7, 21, 8, 22, 9, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24},
    {7, 10, 3, 13, 12, 14, 5, 17, 19, 18, 7, 21, 8, 20, 22, 21, 23, 10, 11, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24},
    {8, 1, 9, 11, 14, 3, 13, 15, 16, 5, 17, 19, 8, 22, 7, 21, 23, 20, 24, 11, 11, 14, 13, 15, 18, 19, 19, 22, 21, 23, 24},
    {9, 8, 22, 24, 17, 4, 16, 18, 13, 14, 9, 10, 11, 20, 21, 22, 24, 17, 16, 18, 19},
    {10, 7, 21, 23, 4, 18, 5, 17, 19, 12, 13, 15, 9, 11, 21, 20, 24, 21, 23, 18, 17, 19, 16, 19},
    {11, 6, 8, 20, 22, 5, 19, 4, 18, 13, 15, 12, 14, 11, 10, 9, 11, 22, 24, 21, 23, 20, 22, 19, 18, 17, 19, 16, 18},
    {12, 5, 19, 6, 20, 7, 21, 10, 11, 12, 13, 14, 17, 18, 19, 20, 21, 22, 23},
    {13, 4, 18, 7, 21, 6, 8, 20, 22, 9, 11, 10, 13, 12, 14, 13, 15, 16, 18, 17, 19, 18, 21, 20, 22, 21, 23, 22, 24},
    {14, 5, 17, 19, 8, 22, 7, 21, 23, 9, 11, 13, 15, 12, 19, 16, 17, 19, 22, 21, 23, 20, 24, 21},
    {15, 4, 16, 18, 23, 8, 22, 24, 11, 10, 15, 14, 13, 19, 16, 18, 23, 22, 24, 21, 20},
    {16, 15, 9, 8, 22, 23, 16, 17, 18, 13, 14, 15, 20, 21, 22, 23},
    {17, 14, 9, 10, 7, 21, 8, 22, 24, 17, 16, 18, 19, 12, 13, 14, 21, 20, 21, 22, 24},
    {18, 13, 15, 10, 9, 11, 6, 20, 24, 7, 21, 23, 18, 17, 19, 16, 13, 12, 13, 15, 22, 21, 20, 24, 21, 23},
    {19, 12, 14, 11, 10, 7, 21, 23, 6, 8, 20, 22, 19, 18, 17, 19, 14, 13, 15, 12, 14, 23, 22, 24, 21, 23, 20, 22},
    {20, 11, 12, 13, 4, 18, 5, 19, 6, 20, 7, 21, 8, 22, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24},
    {21, 10, 13, 12, 14, 5, 17, 19, 18, 7, 21, 8, 20, 22, 21, 23, 10, 11, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24},
    {22, 9, 11, 14, 13, 15, 16, 5, 17, 19, 8, 22, 7, 21, 23, 20, 24, 11, 11, 14, 13, 15, 18, 19, 19, 22, 21, 23, 24},
    {23, 10, 15, 14, 5, 19, 16, 18, 23, 8, 22, 24, 21, 11, 15, 14, 19, 19, 23, 22, 24},
    {24, 9, 15, 4, 18, 17, 24, 23, 8, 22, 11, 10, 15, 14, 19, 18, 24, 23, 22}
}};
static constexpr jdouble CG_COEFF[5][25][40] = {{
    {1.0}
},{
    {1.0, -0.5773502691896256, -0.5773502691896257, -0.5773502691896256},
    {1.9999999999999996}, {1.9999999999999998}, {1.9999999999999996}
},{
    {1.0, -0.5773502691896256, -0.5773502691896257, -0.5773502691896256, 0.4472135954999578, 0.4472135954999578, 0.4472135954999579, 0.4472135954999578, 0.4472135954999578},
    {1.9999999999999996, 0.6324555320336758, 1.095445115010332, -1.095445115010332, -1.095445115010332},
    {1.9999999999999998, -1.0954451150103317, -1.2649110640673515, -1.0954451150103317},
    {1.9999999999999996, -1.095445115010332, -1.095445115010332, 0.6324555320336758, -1.095445115010332},
    {2.0, 1.4142135623730947, 1.0690449676496976, -0.9258200997725514},
    {2.0, 1.414213562373095, -0.9258200997725514, -0.5345224838248488, 0.9258200997725514},
    {2.0, -0.40824829046386296, 0.816496580927726, -0.40824829046386296, 0.5345224838248487, -0.26726124191242434, -0.5345224838248488, -0.26726124191242434, 0.5345224838248487},
    {2.0, 1.414213562373095, -0.9258200997725514, -0.5345224838248488, -0.9258200997725514},
    {2.0, -0.7071067811865474, 0.7071067811865474, 0.4629100498862757, 1.0690449676496976, -0.4629100498862757}
},{
    {1.0, -0.5773502691896256, -0.5773502691896257, -0.5773502691896256, 0.4472135954999578, 0.4472135954999578, 0.4472135954999579, 0.4472135954999578,
        0.4472135954999578, -0.3779644730092272, -0.37796447300922714, -0.37796447300922703, -0.3779644730092272, -0.37796447300922703, -0.37796447300922714, -0.3779644730092272},
    {1.9999999999999996, 0.6324555320336758, 1.095445115010332, -1.095445115010332, -1.095445115010332, -0.2390457218668787, -0.9258200997725513, -0.5855400437691198,
        -0.7559289460184544, 0.828078671210825, 0.7559289460184544, 0.9258200997725513, 0.2390457218668787},
    {1.9999999999999998, -1.0954451150103317, -1.2649110640673515, -1.0954451150103317, 0.7559289460184543, 0.9561828874675148, 1.01418510567422, 0.9561828874675148,
        0.7559289460184543},
    {1.9999999999999996, -1.095445115010332, -1.095445115010332, 0.6324555320336758, -1.095445115010332, 0.9258200997725513, -0.2390457218668787, 0.7559289460184544,
        0.828078671210825, -0.5855400437691198, 0.7559289460184544, -0.2390457218668787, 0.9258200997725513},
    {2.0, 1.4142135623730947, 0.3086066999241838, 1.1952286093343936, -0.9759000729485333, -1.1952286093343936, 0.3086066999241838, 1.0690449676496976,
        -0.9258200997725514, -0.4879500364742665, -0.9759000729485333, 0.7559289460184544, 0.4879500364742665},
    {2.0, 1.414213562373095, 0.7559289460184544, 0.9759000729485331, -1.2344267996967353, -0.9759000729485331, -0.9258200997725514, -0.5345224838248488,
        0.9258200997725514, 0.7715167498104596, 0.5976143046671968, -0.7715167498104596, 0.3086066999241838, -0.5976143046671968},
    {2.0, -0.40824829046386296, -1.0690449676496974, 0.816496580927726, -1.3093073414159544, -0.40824829046386296, -1.0690449676496974, 0.5345224838248487,
        -0.26726124191242434, -0.5345224838248488, -0.26726124191242434, 0.5345224838248487, -0.5455447255899809, 0.3273268353539885, 0.4364357804719848, 0.3273268353539885,
        -0.5455447255899809},
    {2.0, -0.9759000729485331, 1.414213562373095, -1.2344267996967353, 0.7559289460184544, -0.9759000729485331, -0.9258200997725514, -0.5345224838248488,
        -0.9258200997725514, 0.7715167498104596, 0.5976143046671968, 0.3086066999241838, 0.5976143046671968, 0.7715167498104596},
    {2.0, -0.7071067811865474, -1.1952286093343936, -0.3086066999241838, -0.9759000729485333, 0.7071067811865474, 0.3086066999241838, -1.1952286093343936,
        0.4629100498862757, 1.0690449676496976, -0.4629100498862757, -0.4879500364742665, -0.3779644730092272, -0.9759000729485333, 0.3779644730092272, -0.4879500364742665},
    {2.0000000000000004, 1.414213562373095, 1.414213562373095, 0.5773502691896256, -0.9128709291752769, 1.2909944487358058, -0.9128709291752769, 0.5773502691896256},
    {2.0, 1.1547005383792515, 1.1547005383792517, 1.1547005383792515, 1.1547005383792517, -0.7071067811865475, 0.9128709291752769, -0.9128709291752769,
        -0.7071067811865475},
    {1.9999999999999996, 1.2649110640673518, 0.3651483716701107, 1.4605934866804429, -0.3651483716701107, -0.8944271909999159, -0.5773502691896256, -0.3651483716701107,
        0.7071067811865475, -0.7745966692414832, -0.7071067811865475, 0.5773502691896256, 0.8944271909999159},
    {2.0, -0.8944271909999156, 1.549193338482967, -0.8944271909999156, 1.1547005383792515, -0.36514837167011066, -1.0327955589886446, -0.36514837167011066,
        1.1547005383792515},
    {1.9999999999999996, -0.3651483716701107, 1.4605934866804429, 1.2649110640673518, -0.3651483716701107, 0.5773502691896256, -0.8944271909999159, -0.7071067811865475,
        -0.7745966692414832, -0.3651483716701107, -0.7071067811865475, -0.8944271909999159, 0.5773502691896256},
    {2.0, -1.1547005383792515, 1.1547005383792517, 1.1547005383792515, -0.9128709291752769, 0.7071067811865475, -0.7071067811865475, -0.9128709291752769,
        1.1547005383792517},
    {2.0000000000000004, -1.414213562373095, 1.414213562373095, -0.5773502691896256, 0.9128709291752769, 1.2909944487358058, -0.9128709291752769, 0.5773502691896256}
},{
    {1.0, -0.5773502691896256, -0.5773502691896257, -0.5773502691896256, 0.4472135954999578, 0.4472135954999578, 0.4472135954999579, 0.4472135954999578,
        0.4472135954999578, -0.3779644730092272, -0.37796447300922714, -0.37796447300922703, -0.3779644730092272, -0.37796447300922703, -0.37796447300922714, -0.3779644730092272,
        0.33333333333333326, 0.33333333333333326, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.3333333333333333, 0.33333333333333326,
        0.33333333333333326},
    {1.9999999999999996, 0.6324555320336758, 1.095445115010332, -1.095445115010332, -1.095445115010332, -0.2390457218668787, -0.9258200997725513, -0.5855400437691198,
        -0.7559289460184544, 0.828078671210825, 0.7559289460184544, 0.9258200997725513, 0.2390457218668787, 0.1543033499620919, 0.816496580927726, 0.26726124191242434,
        0.7071067811865475, 0.5345224838248488, 0.5976143046671968, -0.6900655593423543, -0.5976143046671968, -0.7071067811865475, -0.26726124191242434, -0.816496580927726,
        -0.1543033499620919},
    {1.9999999999999998, -1.0954451150103317, -1.2649110640673515, -1.0954451150103317, 0.7559289460184543, 0.9561828874675148, 1.01418510567422, 0.9561828874675148,
        0.7559289460184543, -0.5773502691896257, -0.7559289460184543, -0.8451542547285165, -0.8728715609439696, -0.8451542547285165, -0.7559289460184543, -0.5773502691896257},
    {1.9999999999999996, -1.095445115010332, -1.095445115010332, 0.6324555320336758, -1.095445115010332, 0.9258200997725513, -0.2390457218668787, 0.7559289460184544,
        0.828078671210825, -0.5855400437691198, 0.7559289460184544, -0.2390457218668787, 0.9258200997725513, -0.816496580927726, 0.1543033499620919, -0.7071067811865475,
        0.26726124191242434, -0.5976143046671968, -0.6900655593423543, 0.5345224838248488, -0.5976143046671968, 0.26726124191242434, -0.7071067811865475, 0.1543033499620919,
        -0.816496580927726},
    {2.0, 1.4142135623730947, 0.3086066999241838, 1.1952286093343936, -0.9759000729485333, -1.1952286093343936, 0.3086066999241838, 1.0690449676496976,
        0.1781741612749496, -1.0540925533894596, -0.9258200997725514, -0.2817180849095055, -0.7453559924999298, 0.6900655593423541, 0.7453559924999298, -0.2817180849095055,
        1.0540925533894596, -0.4879500364742665, -0.9759000729485333, 0.7559289460184544, 0.4879500364742665, 0.3481553119113957, 0.5222329678670935, 0.8827348295047495,
        -0.3481553119113957, -0.6579516949597689, -0.5222329678670935},
    {2.0, 1.414213562373095, 0.7559289460184544, 0.9759000729485331, -1.2344267996967353, -0.9759000729485331, -0.9258200997725514, -0.2817180849095055,
        -0.7453559924999298, -0.5345224838248488, 0.9258200997725514, -0.7126966450997984, -0.7968190728895957, 0.9759000729485331, 0.7968190728895957, 0.7453559924999298,
        0.2817180849095055, 0.7715167498104596, 0.5976143046671968, -0.7715167498104596, 0.3086066999241838, -0.5976143046671968, -0.6513389472789296, -0.6154574548966636,
        0.6513389472789296, -0.41871789467931186, 0.6154574548966636, -0.20806259464411977, 0.41871789467931186},
    {2.0, -0.40824829046386296, -1.0690449676496974, 0.816496580927726, -1.3093073414159544, -0.40824829046386296, -1.0690449676496974, 0.5345224838248487,
        0.690065559342354, -0.26726124191242434, 0.975900072948533, -0.5345224838248488, 1.0690449676496976, -0.26726124191242434, 0.975900072948533, 0.5345224838248487,
        0.690065559342354, -0.5455447255899809, 0.3273268353539885, 0.4364357804719848, 0.3273268353539885, -0.5455447255899809, 0.5318160234783104, 0.1329540058695776,
        -0.15194743527951726, -0.32288829996897417, -0.3798685881987932, -0.32288829996897417, -0.15194743527951726, 0.1329540058695776, 0.5318160234783104},
    {2.0, -0.9759000729485331, 1.414213562373095, -1.2344267996967353, 0.7559289460184544, -0.9759000729485331, -0.9258200997725514, 0.7453559924999298,
        -0.2817180849095055, 0.7968190728895957, -0.5345224838248488, 0.9759000729485331, -0.9258200997725514, -0.7126966450997984, 0.7968190728895957, -0.2817180849095055,
        0.7453559924999298, 0.7715167498104596, 0.5976143046671968, 0.3086066999241838, 0.5976143046671968, 0.7715167498104596, -0.6513389472789296, -0.6154574548966636,
        -0.41871789467931186, -0.20806259464411977, -0.41871789467931186, -0.6154574548966636, -0.6513389472789296},
    {2.0, -0.7071067811865474, -1.1952286093343936, -0.3086066999241838, -0.9759000729485333, 0.7071067811865474, 0.3086066999241838, -1.1952286093343936,
        1.0540925533894596, 0.4629100498862757, 0.7453559924999298, 0.2817180849095055, 1.0690449676496976, 0.6900655593423541, -0.4629100498862757, -0.2817180849095055,
        0.7453559924999298, 0.1781741612749496, 1.0540925533894596, -0.4879500364742665, -0.3779644730092272, -0.9759000729485333, 0.3779644730092272, -0.4879500364742665,
        0.3481553119113957, 0.5222329678670935, 0.32897584747988445, 0.8827348295047495, -0.32897584747988445, 0.5222329678670935, 0.3481553119113957},
    {2.0000000000000004, 1.414213562373095, 0.23570226039551584, 1.2472191289246473, -0.881917103688197, 1.414213562373095, -1.2472191289246473, 0.23570226039551584,
        0.5773502691896256, -0.9128709291752769, 1.2909944487358058, -0.9128709291752769, 0.5773502691896256, 0.4264014327112209, -0.5504818825631803, 0.7385489458759964,
        0.6513389472789295, -1.1281521496355325, -0.6513389472789295, 0.7385489458759964, -0.5504818825631803},
    {2.0, 1.1547005383792515, 0.408248290463863, 1.0801234497346435, 1.1547005383792517, -1.1547005383792517, 1.1547005383792515, -1.0801234497346435,
        0.408248290463863, 1.1547005383792517, -0.7071067811865475, 0.9128709291752769, -0.9128709291752769, -0.7071067811865475, -0.5504818825631803, -0.9949366763261821,
        -0.8408749651825218, 0.5685352436149611, -0.37605071654517747, -0.24618298195866548, 0.37605071654517747, 0.5685352436149611, 0.8408749651825218, 0.5504818825631803},
    {1.9999999999999996, 1.2649110640673518, 0.3651483716701107, 0.816496580927726, 0.9128709291752769, 1.4605934866804429, -1.2909944487358058, -0.3651483716701107,
        -0.9128709291752769, -0.8944271909999159, -0.5773502691896256, -0.3651483716701107, 0.7071067811865475, -0.7745966692414832, -0.7071067811865475, 0.5773502691896256,
        0.8944271909999159, 0.7385489458759964, 0.6513389472789295, 0.5685352436149611, -0.37605071654517747, 0.14213381090374036, -0.6356417261637282, 0.5504818825631803,
        0.6356417261637282, 0.37605071654517747, -0.5685352436149611, -0.6513389472789295, -0.7385489458759964},
    {2.0, -0.8944271909999156, -1.0540925533894598, 1.549193338482967, -1.3333333333333335, -0.8944271909999156, -1.0540925533894598, 1.1547005383792515,
        -0.36514837167011066, -1.0327955589886446, -0.36514837167011066, 1.1547005383792515, -1.1281521496355322, -0.24618298195866542, 0.5504818825631801, 0.8528028654224419,
        0.5504818825631801, -0.24618298195866542, -1.1281521496355322},
    {1.9999999999999996, -0.3651483716701107, -0.9128709291752769, 1.4605934866804429, -1.2909944487358058, 1.2649110640673518, -0.3651483716701107, 0.816496580927726,
        -0.9128709291752769, 0.5773502691896256, -0.8944271909999159, -0.7071067811865475, -0.7745966692414832, -0.3651483716701107, -0.7071067811865475, -0.8944271909999159,
        0.5773502691896256, -0.6513389472789295, 0.7385489458759964, 0.37605071654517747, 0.5685352436149611, 0.6356417261637282, 0.5504818825631803, 0.14213381090374036,
        0.6356417261637282, 0.5685352436149611, 0.37605071654517747, 0.7385489458759964, -0.6513389472789295},
    {2.0, -1.1547005383792515, -1.0801234497346435, -0.408248290463863, 1.1547005383792517, -1.1547005383792517, 1.1547005383792515, 0.408248290463863,
        -1.0801234497346435, -0.9128709291752769, 0.7071067811865475, -0.7071067811865475, -0.9128709291752769, 1.1547005383792517, -0.5504818825631803, 0.8408749651825218,
        0.37605071654517747, -0.5685352436149611, -0.24618298195866548, 0.5685352436149611, 0.37605071654517747, -0.9949366763261821, 0.8408749651825218, -0.5504818825631803},
    {2.0000000000000004, -1.414213562373095, -1.2472191289246473, -0.23570226039551584, -0.881917103688197, 1.414213562373095, 0.23570226039551584, -1.2472191289246473,
        -0.5773502691896256, 0.9128709291752769, 1.2909944487358058, -0.9128709291752769, 0.5773502691896256, 0.5504818825631803, -0.6513389472789295, -0.7385489458759964,
        -1.1281521496355325, 0.7385489458759964, -0.6513389472789295, -0.5504818825631803, 0.4264014327112209},
    {2.0, 1.414213562373095, 1.414213562373095, 1.414213562373095, 0.4670993664969138, -0.8738628975053029, 1.4270121360253518, -0.8738628975053029,
        0.4670993664969138, 0.7385489458759963, -0.9534625892455924, 0.7385489458759963, 0.6257862187747438, -0.699650262281441, 0.7933288280219175, -0.699650262281441},
    {2.0, 1.2247448713915892, 1.0, 1.2247448713915892, 1.0, 0.7006490497453706, 1.0, -0.8257228238447704,
        0.8738628975053029, 0.3567530340063379, -0.8738628975053029, -0.8257228238447704, 0.7006490497453706, 1.2792042981336627, -0.42640143271122083, -0.42640143271122083,
        -0.699650262281441, -0.9386793281621156, 0.26444294267397245, 0.26444294267397245, 0.699650262281441},
    {2.0, 1.0350983390135313, 0.2672612419124244, 1.3093073414159544, -0.2672612419124244, 1.0350983390135313, 0.9258200997725513, 1.184313050927584,
        -0.4670993664969138, 1.0690449676496976, -0.5617690055391233, 0.8257228238447704, -0.4077177531501005, -0.8257228238447704, -0.5617690055391233, 0.4670993664969138,
        -0.8374357893586237, 0.27914526311954124, -0.7207499701564472, 0.8374357893586237, 0.7933288280219175, 0.26444294267397245, -0.4916891718944415, -0.7933288280219175,
        0.5997002248126638, -0.26444294267397245},
    {2.0, 1.1952286093343938, 0.4629100498862757, 1.4638501094227998, -0.4629100498862757, -0.3779644730092272, -0.8827348295047495, -0.7006490497453706,
        1.3093073414159542, 0.3779644730092272, -0.27914526311954124, 0.5617690055391233, -0.8664002254439636, -0.5617690055391233, 0.7006490497453706, 0.8827348295047495,
        0.6241877839323592, -0.6446583712203041, -0.6241877839323592, -0.6241877839323593, 0.6446583712203041, -0.699650262281441, 0.26444294267397245, 0.699650262281441,
        0.5997002248126638, -0.26444294267397245, 0.4022911406409067, -0.5997002248126638},
    {2.0, -0.9258200997725513, 1.511857892036909, -0.9258200997725513, 0.11952286093343935, 1.1843130509275839, -0.4780914437337574, -0.2791452631195412,
        0.7171371656006362, -1.0192943828752512, -0.4780914437337574, -0.2791452631195412, 0.11952286093343935, 1.1843130509275839, -0.24174688920761406, 0.5640760748177661,
        -0.08058229640253806, -0.4834937784152282, -0.08058229640253806, 0.5640760748177661, -0.24174688920761406, 0.31289310938737186, -0.46933966408105776, -0.24584458594722075,
        0.20114557032045333, 0.4022911406409068, 0.20114557032045333, -0.24584458594722075, -0.46933966408105776, 0.31289310938737186},
    {2.0, -0.4629100498862757, 1.4638501094227998, 1.1952286093343938, -0.4629100498862757, -0.3779644730092272, 0.7006490497453706, -0.8827348295047495,
        -0.5617690055391233, 1.3093073414159542, -0.8664002254439636, -0.3779644730092272, -0.27914526311954124, -0.5617690055391233, -0.8827348295047495, 0.7006490497453706,
        0.6241877839323592, -0.6446583712203041, -0.6241877839323593, -0.6446583712203041, 0.6241877839323592, -0.699650262281441, 0.26444294267397245, 0.5997002248126638,
        0.4022911406409067, 0.5997002248126638, 0.26444294267397245, -0.699650262281441},
    {2.0, -0.2672612419124244, -1.0350983390135313, 1.3093073414159544, 1.0350983390135313, -0.2672612419124244, 0.4670993664969138, -0.5345224838248488,
        -0.8257228238447704, 0.5617690055391233, 0.9258200997725513, -0.4077177531501005, 0.5345224838248488, -0.5617690055391233, -0.8257228238447704, 1.184313050927584,
        0.4670993664969138, -0.8374357893586237, 0.3603749850782236, 0.27914526311954124, -0.3603749850782236, -0.8374357893586237, 0.7933288280219175, 0.26444294267397245,
        -0.2998501124063319, -0.4916891718944415, 0.2998501124063319, 0.26444294267397245, 0.7933288280219175},
    {2.0, -1.2247448713915892, 1.0, 1.2247448713915892, -1.0, -0.7006490497453706, -0.8738628975053029, 0.8257228238447704,
        0.3567530340063379, 1.0, -0.8257228238447704, -0.8738628975053029, 0.7006490497453706, 0.42640143271122083, 1.2792042981336627, -0.42640143271122083,
        -0.699650262281441, -0.26444294267397245, -0.9386793281621156, 0.26444294267397245, -0.699650262281441},
    {2.0, -1.414213562373095, 1.414213562373095, -0.7071067811865475, -0.4670993664969138, 0.8738628975053029, 1.4270121360253518, -0.8738628975053029,
        0.7071067811865475, 0.4670993664969138, -0.7385489458759963, 0.4767312946227962, 0.7385489458759963, -0.4767312946227962, 0.699650262281441, -0.39666441401095875,
        0.6257862187747438, -0.699650262281441, 0.39666441401095875}
}};


template <jint LMAX, jint CGIDX, jint SUBIDX>
static inline jdouble mplusMnlmSubSub_(jdouble *aAnlm) noexcept {
    constexpr jint i1 = CG_INDEX1[LMAX][CGIDX][SUBIDX];
    constexpr jint i2 = CG_INDEX2[LMAX][CGIDX][SUBIDX];
    constexpr jdouble coeff = CG_COEFF[LMAX][CGIDX][SUBIDX];
    return coeff * aAnlm[i1] * aAnlm[i2];
}
template <jint LMAX, jint CGIDX>
static jdouble mplusMnlmSub_(jdouble *aAnlm) noexcept {
    constexpr jint tSize = CG_SIZE[LMAX][CGIDX];
    jdouble rSubMnlm = 0.0;
    if (tSize==0) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 0>(aAnlm);
    if (tSize==1) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 1>(aAnlm);
    if (tSize==2) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 2>(aAnlm);
    if (tSize==3) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 3>(aAnlm);
    if (tSize==4) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 4>(aAnlm);
    if (tSize==5) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 5>(aAnlm);
    if (tSize==6) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 6>(aAnlm);
    if (tSize==7) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 7>(aAnlm);
    if (tSize==8) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 8>(aAnlm);
    if (tSize==9) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 9>(aAnlm);
    if (tSize==10) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 10>(aAnlm);
    if (tSize==11) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 11>(aAnlm);
    if (tSize==12) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 12>(aAnlm);
    if (tSize==13) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 13>(aAnlm);
    if (tSize==14) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 14>(aAnlm);
    if (tSize==15) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 15>(aAnlm);
    if (tSize==16) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 16>(aAnlm);
    if (tSize==17) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 17>(aAnlm);
    if (tSize==18) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 18>(aAnlm);
    if (tSize==19) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 19>(aAnlm);
    if (tSize==20) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 20>(aAnlm);
    if (tSize==21) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 21>(aAnlm);
    if (tSize==22) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 22>(aAnlm);
    if (tSize==23) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 23>(aAnlm);
    if (tSize==24) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 24>(aAnlm);
    if (tSize==25) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 25>(aAnlm);
    if (tSize==26) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 26>(aAnlm);
    if (tSize==27) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 27>(aAnlm);
    if (tSize==28) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 28>(aAnlm);
    if (tSize==29) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 29>(aAnlm);
    if (tSize==30) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 30>(aAnlm);
    if (tSize==31) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 31>(aAnlm);
    if (tSize==32) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 32>(aAnlm);
    if (tSize==33) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 33>(aAnlm);
    if (tSize==34) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 34>(aAnlm);
    if (tSize==35) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 35>(aAnlm);
    if (tSize==36) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 36>(aAnlm);
    if (tSize==37) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 37>(aAnlm);
    if (tSize==38) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 38>(aAnlm);
    if (tSize==39) {return rSubMnlm;} rSubMnlm += mplusMnlmSubSub_<LMAX, CGIDX, 39>(aAnlm);
    return rSubMnlm;
}
template <jint LMAX>
static void mplusMnlm_(jdouble *rMnlm, jdouble *aAnlm) noexcept {
    rMnlm[0] += mplusMnlmSub_<LMAX, 0>(aAnlm);
    if (LMAX==0) return;
    rMnlm[1] += mplusMnlmSub_<LMAX, 1>(aAnlm);
    rMnlm[2] += mplusMnlmSub_<LMAX, 2>(aAnlm);
    rMnlm[3] += mplusMnlmSub_<LMAX, 3>(aAnlm);
    if (LMAX==1) return;
    rMnlm[4] += mplusMnlmSub_<LMAX, 4>(aAnlm);
    rMnlm[5] += mplusMnlmSub_<LMAX, 5>(aAnlm);
    rMnlm[6] += mplusMnlmSub_<LMAX, 6>(aAnlm);
    rMnlm[7] += mplusMnlmSub_<LMAX, 7>(aAnlm);
    rMnlm[8] += mplusMnlmSub_<LMAX, 8>(aAnlm);
    if (LMAX==2) return;
    rMnlm[9] += mplusMnlmSub_<LMAX, 9>(aAnlm);
    rMnlm[10] += mplusMnlmSub_<LMAX, 10>(aAnlm);
    rMnlm[11] += mplusMnlmSub_<LMAX, 11>(aAnlm);
    rMnlm[12] += mplusMnlmSub_<LMAX, 12>(aAnlm);
    rMnlm[13] += mplusMnlmSub_<LMAX, 13>(aAnlm);
    rMnlm[14] += mplusMnlmSub_<LMAX, 14>(aAnlm);
    rMnlm[15] += mplusMnlmSub_<LMAX, 15>(aAnlm);
    if (LMAX==3) return;
    rMnlm[16] += mplusMnlmSub_<LMAX, 16>(aAnlm);
    rMnlm[17] += mplusMnlmSub_<LMAX, 17>(aAnlm);
    rMnlm[18] += mplusMnlmSub_<LMAX, 18>(aAnlm);
    rMnlm[19] += mplusMnlmSub_<LMAX, 19>(aAnlm);
    rMnlm[20] += mplusMnlmSub_<LMAX, 20>(aAnlm);
    rMnlm[21] += mplusMnlmSub_<LMAX, 21>(aAnlm);
    rMnlm[22] += mplusMnlmSub_<LMAX, 22>(aAnlm);
    rMnlm[23] += mplusMnlmSub_<LMAX, 23>(aAnlm);
    rMnlm[24] += mplusMnlmSub_<LMAX, 24>(aAnlm);
}
template <jint LMAX>
static void mplusMnlm(jdouble *rMnlm, jdouble *aAnlm, jint aEquSize) noexcept {
    constexpr jint tLMAll = (LMAX+1)*(LMAX+1);
    jdouble *tMnlm = rMnlm;
    jdouble *tAnlm = aAnlm;
    for (jint np = 0; np < aEquSize; ++np) {
        mplusMnlm_<LMAX>(tMnlm, tAnlm);
        tMnlm += tLMAll;
        tAnlm += tLMAll;
    }
}
static void mplusMnlm(jdouble *rMnlm, jdouble *aAnlm, jint aEquSize, jint aLMax) noexcept {
    switch (aLMax) {
    case 0: {mplusMnlm<0>(rMnlm, aAnlm, aEquSize); return;}
    case 1: {mplusMnlm<1>(rMnlm, aAnlm, aEquSize); return;}
    case 2: {mplusMnlm<2>(rMnlm, aAnlm, aEquSize); return;}
    case 3: {mplusMnlm<3>(rMnlm, aAnlm, aEquSize); return;}
    case 4: {mplusMnlm<4>(rMnlm, aAnlm, aEquSize); return;}
    default: {return;}
    }
}

template <jint LMAX, jint CGIDX, jint SUBIDX>
static inline void mplusGradMnlmSubSub_(jdouble aSubGradMnlm, jdouble *aAnlm, jdouble *rGradAnlm) noexcept {
    constexpr jint i1 = CG_INDEX1[LMAX][CGIDX][SUBIDX];
    constexpr jint i2 = CG_INDEX2[LMAX][CGIDX][SUBIDX];
    constexpr jdouble coeff = CG_COEFF[LMAX][CGIDX][SUBIDX];
    const jdouble tMul = coeff * aSubGradMnlm;
    rGradAnlm[i1] += tMul * aAnlm[i2];
    rGradAnlm[i2] += tMul * aAnlm[i1];
}
template <jint LMAX, jint CGIDX>
static void mplusGradMnlmSub_(jdouble aSubGradMnlm, jdouble *aAnlm, jdouble *rGradAnlm) noexcept {
    constexpr jint tSize = CG_SIZE[LMAX][CGIDX];
    if (tSize==0) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 0>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==1) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 1>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==2) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 2>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==3) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 3>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==4) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 4>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==5) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 5>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==6) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 6>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==7) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 7>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==8) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 8>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==9) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 9>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==10) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 10>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==11) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 11>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==12) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 12>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==13) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 13>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==14) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 14>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==15) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 15>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==16) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 16>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==17) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 17>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==18) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 18>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==19) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 19>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==20) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 20>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==21) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 21>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==22) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 22>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==23) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 23>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==24) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 24>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==25) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 25>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==26) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 26>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==27) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 27>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==28) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 28>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==29) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 29>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==30) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 30>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==31) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 31>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==32) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 32>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==33) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 33>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==34) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 34>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==35) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 35>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==36) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 36>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==37) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 37>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==38) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 38>(aSubGradMnlm, aAnlm, rGradAnlm);
    if (tSize==39) {return;} mplusGradMnlmSubSub_<LMAX, CGIDX, 39>(aSubGradMnlm, aAnlm, rGradAnlm);
}
template <jint LMAX>
static void mplusGradMnlm_(jdouble *aGradMnlm, jdouble *aAnlm, jdouble *rGradAnlm) noexcept {
    mplusGradMnlmSub_<LMAX, 0>(aGradMnlm[0], aAnlm, rGradAnlm);
    if (LMAX==0) return;
    mplusGradMnlmSub_<LMAX, 1>(aGradMnlm[1], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 2>(aGradMnlm[2], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 3>(aGradMnlm[3], aAnlm, rGradAnlm);
    if (LMAX==1) return;
    mplusGradMnlmSub_<LMAX, 4>(aGradMnlm[4], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 5>(aGradMnlm[5], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 6>(aGradMnlm[6], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 7>(aGradMnlm[7], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 8>(aGradMnlm[8], aAnlm, rGradAnlm);
    if (LMAX==2) return;
    mplusGradMnlmSub_<LMAX, 9>(aGradMnlm[9], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 10>(aGradMnlm[10], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 11>(aGradMnlm[11], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 12>(aGradMnlm[12], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 13>(aGradMnlm[13], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 14>(aGradMnlm[14], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 15>(aGradMnlm[15], aAnlm, rGradAnlm);
    if (LMAX==3) return;
    mplusGradMnlmSub_<LMAX, 16>(aGradMnlm[16], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 17>(aGradMnlm[17], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 18>(aGradMnlm[18], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 19>(aGradMnlm[19], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 20>(aGradMnlm[20], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 21>(aGradMnlm[21], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 22>(aGradMnlm[22], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 23>(aGradMnlm[23], aAnlm, rGradAnlm);
    mplusGradMnlmSub_<LMAX, 24>(aGradMnlm[24], aAnlm, rGradAnlm);
}
template <jint LMAX>
static void mplusGradMnlm(jdouble *aGradMnlm, jdouble *aAnlm, jdouble *rGradAnlm, jint aEquSize) noexcept {
    constexpr jint tLMAll = (LMAX+1)*(LMAX+1);
    jdouble *tGradMnlm = aGradMnlm;
    jdouble *tGradAnlm = rGradAnlm;
    jdouble *tAnlm = aAnlm;
    for (jint np = 0; np < aEquSize; ++np) {
        mplusGradMnlm_<LMAX>(tGradMnlm, tAnlm, tGradAnlm);
        tGradMnlm += tLMAll;
        tGradAnlm += tLMAll;
        tAnlm += tLMAll;
    }
}
static void mplusGradMnlm(jdouble *aGradMnlm, jdouble *aAnlm, jdouble *rGradAnlm, jint aEquSize, jint aLMax) noexcept {
    switch (aLMax) {
    case 0: {mplusGradMnlm<0>(aGradMnlm, aAnlm, rGradAnlm, aEquSize); return;}
    case 1: {mplusGradMnlm<1>(aGradMnlm, aAnlm, rGradAnlm, aEquSize); return;}
    case 2: {mplusGradMnlm<2>(aGradMnlm, aAnlm, rGradAnlm, aEquSize); return;}
    case 3: {mplusGradMnlm<3>(aGradMnlm, aAnlm, rGradAnlm, aEquSize); return;}
    case 4: {mplusGradMnlm<4>(aGradMnlm, aAnlm, rGradAnlm, aEquSize); return;}
    default: {return;}
    }
}

template <jint LMAX, jint CGIDX, jint SUBIDX>
static inline jdouble mplusGradNNGradMnlmSubSub_(jdouble *aAnlm, jdouble *aGradNNGradAnlm) noexcept {
    constexpr jint i1 = CG_INDEX1[LMAX][CGIDX][SUBIDX];
    constexpr jint i2 = CG_INDEX2[LMAX][CGIDX][SUBIDX];
    constexpr jdouble coeff = CG_COEFF[LMAX][CGIDX][SUBIDX];
    return coeff * (aAnlm[i2]*aGradNNGradAnlm[i1] + aAnlm[i1]*aGradNNGradAnlm[i2]);
}
template <jint LMAX, jint CGIDX>
static jdouble mplusGradNNGradMnlmSub_(jdouble *aAnlm, jdouble *aGradNNGradAnlm) noexcept {
    constexpr jint tSize = CG_SIZE[LMAX][CGIDX];
    jdouble rSubGGMnlm = 0.0;
    if (tSize==0) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 0>(aAnlm, aGradNNGradAnlm);
    if (tSize==1) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 1>(aAnlm, aGradNNGradAnlm);
    if (tSize==2) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 2>(aAnlm, aGradNNGradAnlm);
    if (tSize==3) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 3>(aAnlm, aGradNNGradAnlm);
    if (tSize==4) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 4>(aAnlm, aGradNNGradAnlm);
    if (tSize==5) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 5>(aAnlm, aGradNNGradAnlm);
    if (tSize==6) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 6>(aAnlm, aGradNNGradAnlm);
    if (tSize==7) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 7>(aAnlm, aGradNNGradAnlm);
    if (tSize==8) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 8>(aAnlm, aGradNNGradAnlm);
    if (tSize==9) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 9>(aAnlm, aGradNNGradAnlm);
    if (tSize==10) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 10>(aAnlm, aGradNNGradAnlm);
    if (tSize==11) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 11>(aAnlm, aGradNNGradAnlm);
    if (tSize==12) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 12>(aAnlm, aGradNNGradAnlm);
    if (tSize==13) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 13>(aAnlm, aGradNNGradAnlm);
    if (tSize==14) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 14>(aAnlm, aGradNNGradAnlm);
    if (tSize==15) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 15>(aAnlm, aGradNNGradAnlm);
    if (tSize==16) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 16>(aAnlm, aGradNNGradAnlm);
    if (tSize==17) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 17>(aAnlm, aGradNNGradAnlm);
    if (tSize==18) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 18>(aAnlm, aGradNNGradAnlm);
    if (tSize==19) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 19>(aAnlm, aGradNNGradAnlm);
    if (tSize==20) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 20>(aAnlm, aGradNNGradAnlm);
    if (tSize==21) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 21>(aAnlm, aGradNNGradAnlm);
    if (tSize==22) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 22>(aAnlm, aGradNNGradAnlm);
    if (tSize==23) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 23>(aAnlm, aGradNNGradAnlm);
    if (tSize==24) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 24>(aAnlm, aGradNNGradAnlm);
    if (tSize==25) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 25>(aAnlm, aGradNNGradAnlm);
    if (tSize==26) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 26>(aAnlm, aGradNNGradAnlm);
    if (tSize==27) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 27>(aAnlm, aGradNNGradAnlm);
    if (tSize==28) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 28>(aAnlm, aGradNNGradAnlm);
    if (tSize==29) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 29>(aAnlm, aGradNNGradAnlm);
    if (tSize==30) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 30>(aAnlm, aGradNNGradAnlm);
    if (tSize==31) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 31>(aAnlm, aGradNNGradAnlm);
    if (tSize==32) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 32>(aAnlm, aGradNNGradAnlm);
    if (tSize==33) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 33>(aAnlm, aGradNNGradAnlm);
    if (tSize==34) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 34>(aAnlm, aGradNNGradAnlm);
    if (tSize==35) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 35>(aAnlm, aGradNNGradAnlm);
    if (tSize==36) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 36>(aAnlm, aGradNNGradAnlm);
    if (tSize==37) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 37>(aAnlm, aGradNNGradAnlm);
    if (tSize==38) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 38>(aAnlm, aGradNNGradAnlm);
    if (tSize==39) {return rSubGGMnlm;} rSubGGMnlm += mplusGradNNGradMnlmSubSub_<LMAX, CGIDX, 39>(aAnlm, aGradNNGradAnlm);
    return rSubGGMnlm;
}
template <jint LMAX>
static void mplusGradNNGradMnlm_(jdouble *rGradNNGradMnlm, jdouble *aAnlm, jdouble *aGradNNGradAnlm) noexcept {
    rGradNNGradMnlm[0] += mplusGradNNGradMnlmSub_<LMAX, 0>(aAnlm, aGradNNGradAnlm);
    if (LMAX==0) return;
    rGradNNGradMnlm[1] += mplusGradNNGradMnlmSub_<LMAX, 1>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[2] += mplusGradNNGradMnlmSub_<LMAX, 2>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[3] += mplusGradNNGradMnlmSub_<LMAX, 3>(aAnlm, aGradNNGradAnlm);
    if (LMAX==1) return;
    rGradNNGradMnlm[4] += mplusGradNNGradMnlmSub_<LMAX, 4>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[5] += mplusGradNNGradMnlmSub_<LMAX, 5>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[6] += mplusGradNNGradMnlmSub_<LMAX, 6>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[7] += mplusGradNNGradMnlmSub_<LMAX, 7>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[8] += mplusGradNNGradMnlmSub_<LMAX, 8>(aAnlm, aGradNNGradAnlm);
    if (LMAX==2) return;
    rGradNNGradMnlm[9] += mplusGradNNGradMnlmSub_<LMAX, 9>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[10] += mplusGradNNGradMnlmSub_<LMAX, 10>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[11] += mplusGradNNGradMnlmSub_<LMAX, 11>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[12] += mplusGradNNGradMnlmSub_<LMAX, 12>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[13] += mplusGradNNGradMnlmSub_<LMAX, 13>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[14] += mplusGradNNGradMnlmSub_<LMAX, 14>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[15] += mplusGradNNGradMnlmSub_<LMAX, 15>(aAnlm, aGradNNGradAnlm);
    if (LMAX==3) return;
    rGradNNGradMnlm[16] += mplusGradNNGradMnlmSub_<LMAX, 16>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[17] += mplusGradNNGradMnlmSub_<LMAX, 17>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[18] += mplusGradNNGradMnlmSub_<LMAX, 18>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[19] += mplusGradNNGradMnlmSub_<LMAX, 19>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[20] += mplusGradNNGradMnlmSub_<LMAX, 20>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[21] += mplusGradNNGradMnlmSub_<LMAX, 21>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[22] += mplusGradNNGradMnlmSub_<LMAX, 22>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[23] += mplusGradNNGradMnlmSub_<LMAX, 23>(aAnlm, aGradNNGradAnlm);
    rGradNNGradMnlm[24] += mplusGradNNGradMnlmSub_<LMAX, 24>(aAnlm, aGradNNGradAnlm);
}
template <jint LMAX>
static void mplusGradNNGradMnlm(jdouble *rGradNNGradMnlm, jdouble *aAnlm, jdouble *aGradNNGradAnlm, jint aEquSize) noexcept {
    constexpr jint tLMAll = (LMAX+1)*(LMAX+1);
    jdouble *tGradNNGradMnlm = rGradNNGradMnlm;
    jdouble *tGradNNGradAnlm = aGradNNGradAnlm;
    jdouble *tAnlm = aAnlm;
    for (jint np = 0; np < aEquSize; ++np) {
        mplusGradNNGradMnlm_<LMAX>(tGradNNGradMnlm, tAnlm, tGradNNGradAnlm);
        tGradNNGradMnlm += tLMAll;
        tGradNNGradAnlm += tLMAll;
        tAnlm += tLMAll;
    }
}
static void mplusGradNNGradMnlm(jdouble *rGradNNGradMnlm, jdouble *aAnlm, jdouble *aGradNNGradAnlm, jint aEquSize, jint aLMax) noexcept {
    switch (aLMax) {
    case 0: {mplusGradNNGradMnlm<0>(rGradNNGradMnlm, aAnlm, aGradNNGradAnlm, aEquSize); return;}
    case 1: {mplusGradNNGradMnlm<1>(rGradNNGradMnlm, aAnlm, aGradNNGradAnlm, aEquSize); return;}
    case 2: {mplusGradNNGradMnlm<2>(rGradNNGradMnlm, aAnlm, aGradNNGradAnlm, aEquSize); return;}
    case 3: {mplusGradNNGradMnlm<3>(rGradNNGradMnlm, aAnlm, aGradNNGradAnlm, aEquSize); return;}
    case 4: {mplusGradNNGradMnlm<4>(rGradNNGradMnlm, aAnlm, aGradNNGradAnlm, aEquSize); return;}
    default: {return;}
    }
}

template <jint LMAX>
static void mplusGradMnlmAnlm(jdouble *aNNGradMnlm, jdouble *rGradAnlm, jdouble *aGradNNGradAnlm, jint aEquSize) noexcept {
    constexpr jint tLMAll = (LMAX+1)*(LMAX+1);
    jdouble *tNNGradMnlm = aNNGradMnlm;
    jdouble *tGradNNGradAnlm = aGradNNGradAnlm;
    jdouble *tGradAnlm = rGradAnlm;
    for (jint np = 0; np < aEquSize; ++np) {
        mplusGradMnlm_<LMAX>(tNNGradMnlm, tGradNNGradAnlm, tGradAnlm);
        tNNGradMnlm += tLMAll;
        tGradNNGradAnlm += tLMAll;
        tGradAnlm += tLMAll;
    }
}
static void mplusGradMnlmAnlm(jdouble *aNNGradMnlm, jdouble *rGradAnlm, jdouble *aGradNNGradAnlm, jint aEquSize, jint aLMax) noexcept {
    switch (aLMax) {
    case 0: {mplusGradMnlmAnlm<0>(aNNGradMnlm, rGradAnlm, aGradNNGradAnlm, aEquSize); return;}
    case 1: {mplusGradMnlmAnlm<1>(aNNGradMnlm, rGradAnlm, aGradNNGradAnlm, aEquSize); return;}
    case 2: {mplusGradMnlmAnlm<2>(aNNGradMnlm, rGradAnlm, aGradNNGradAnlm, aEquSize); return;}
    case 3: {mplusGradMnlmAnlm<3>(aNNGradMnlm, rGradAnlm, aGradNNGradAnlm, aEquSize); return;}
    case 4: {mplusGradMnlmAnlm<4>(aNNGradMnlm, rGradAnlm, aGradNNGradAnlm, aEquSize); return;}
    default: {return;}
    }
}

}

#endif //BASIS_EQUIVARIANT_UTIL_H